<html>
<head>
<meta charset="UTF-8">
<title>signup</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
<link rel="stylesheet" href="./css/login.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="./js/api.js"></script>

</head>
<body class="text-center">
    <div class="mx-auto" style="width: 200px;">
        <div class="card" style="width: 18rem;">
            <main class="form-signin">
                <form>
                    <h1 class="h3 mb-3 fw-normal">グループをつくる</h1>
                    <p>We Walletを一緒に使うグループ名を決めましょう</p>
                    <label for="inputId" class="visually-hidden">グループ名</label>
                    <p class="text-danger"></p>
                    <input type="id" id="inputGroupName" class="form-control" placeholder="例)チームゴリラ" required="true" autofocus="" maxlength="64">
                    <br>
                    <button class="w-100 btn btn-lg btn-primary" id="signup" type="button">登録</button>
                    <p class="mt-5 mb-3 text-muted">© 2022</p>
                </form>
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script>

        $('#signup').on('click', function() {
            signup();
        });

        function signup() {
            let name = document.getElementById('inputGroupName').value;
            var arr = { groupname: name};
            var login_info = JSON.stringify(arr);
        $.ajax({
                url:"http://localhost:8080/api/signup",
                type: "POST",
                async: true,
                dataType: "json",
                contentType: "application/json",
                timeout: 5000,
                cache: false,
                data: login_info,
                success: function (responseData) {
                  // 成功時処理
                  window.location.href = "group?id=" +  responseData.groupId;
                },
                error: function (xhr, textStatus, errorThrown) {
                  // 失敗時処理
                  var res = $.parseJSON(xhr.responseText);
                  $('.text-danger').text(res.errorMessage);
                  window.location.reload;
                },
              });
        }
    </script>
</body>
</html>